<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>YAWS setup</title>
  <link rel="icon" href="data:;base64,iVBORw0KGgo=">
  <style>
    * { box-sizing: border-box; }
    html { height: 100%; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Cantarell, Ubuntu, roboto, noto, arial, sans-serif;
      font-size: 17px; padding: 0; margin: 0; min-height: 100%;
      display: flex; justify-content: center; background-color: white; color: #555;
    }
    main { max-width: 600px; flex-grow: 1; padding: 30px 10px; }
    h1 { font-size: 28px; margin: 0 0 20px 0; border-bottom: 1px solid #555; }
    h2 { font-size: 24px; margin: 24px 0 16px 0; }
    section.readings { display: flex; justify-content: space-between; }
    section.readings p { display: inline-block; margin: 0; width: 33%; }
    table, tr, td { padding: 0 0 8px 0; border: 0; }
    td.left { padding-right: 20px; }
    input[type=text] {
      font-family: inherit; font-size: 18px; color: inherit; background-color: inherit;
      box-shadow: none; -webkit-box-shadow: none; -webkit-appearance: none;
      border-radius: 3px; border: 1px solid #888; padding: 2px 5px;
      width: 80px; text-align: center;
    }
    button {
      font-family: inherit; font-size: inherit;
    }
  </style>
</head>
<body>
<script>

  document.addEventListener("DOMContentLoaded", () => {
    updateReadings();
    // document.getElementById("start").addEventListener("click", step10);
  });

  async function updateReadings() {
    const response = await fetch("/readings", {
      method: 'GET',
    });
    let gotReadings = false;
    if (response.status == 200) {
      try {
        let data = await response.json();
        document.getElementById("pres").innerText = data.pres + " hPa";
        document.getElementById("humi").innerText = data.humi + "%";
        document.getElementById("temp").innerText = data.temp + "Â°C";
        gotReadings = true;
      }
      catch {}
    }
    if (!gotReadings) {
      document.getElementById("pres").innerText = "n/a";
      document.getElementById("humi").innerText = "n/a";
      document.getElementById("temp").innerText = "n/a";
    }
    setTimeout(updateReadings, 500);
  }

</script>
<main>
  <h1>YAWS: Yet Another Weather Station</h1>
  <section class="readings">
    <p><b>Pressure: </b> <span id="pres">n/a</span></p>
    <p><b>Humidity: </b> <span id="humi">n/a</span></p>
    <p><b>Temperature: </b> <span id="temp">n/a</span></p>
  </section>
  <h2>Configure</h2>
  <table>
    <tr>
      <td class="left">Altitude above sea level:</td>
      <td><input type="text" id="txtAltitude"> m</td>
    </tr>
    <tr>
      <td class="left"></td>
      <td><button type="submit" id="btnSave">Save changes</button></td>
    </tr>
  </table>
  <h2>Update firmware</h2>
</main>
</body>
</html>